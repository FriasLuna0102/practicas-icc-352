<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Registros</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <style>
        table {
            width: 100%;
        }
        th, td {
            border: 1px solid black;
            padding: 8px;
            text-align: left;
        }
        th {
            background-color: #f2f2f2;
        }
        button {
            margin: 5px;
        }
    </style>
</head>
<body>
<div class="container">
    <h1>Registros</h1>
    <table class="table table-striped">
        <thead class="thead-dark">
        <tr>
            <th>Nombre</th>
            <th>Sector</th>
            <th>Nivel Escolar</th>
            <th>Usuario</th>
            <th>Latitud</th>
            <th>Longitud</th>
            <th>Estado</th>
        </tr>
        </thead>
        <tbody id="tablaRegistros">
        <!-- Los registros se agregarán aquí -->
        </tbody>
    </table>
    <button class="btn btn-primary">Sincronizar</button>
    <button class="btn btn-success">Registrar Registro</button>
    <button class="btn btn-warning">Modificar</button>
    <button class="btn btn-danger">Eliminar</button>
    <button class="btn btn-secondary">Cerrar</button>
</div>

<script>
    // Abre la base de datos
    var indexedDB = window.indexedDB || window.mozIndexedDB || window.webkitIndexedDB || window.msIndexedDB;
    var dataBase = indexedDB.open("FormularioDB", 1);

    // Manejador de éxito de la apertura de la base de datos
    dataBase.onsuccess = function (e) {
        var db = e.target.result;
        var transaccion = db.transaction(["formularios"], "readonly");
        var formularios = transaccion.objectStore("formularios");

        // Abrir un cursor para recorrer los datos
        formularios.openCursor().onsuccess = function (event) {
            var cursor = event.target.result;
            if (cursor) {
                // Crear una nueva fila en la tabla para cada registro
                var fila = document.createElement("tr");
                fila.innerHTML = `
                    <td>${cursor.value.nombre}</td>
                    <td>${cursor.value.sector}</td>
                    <td>${cursor.value.nivelEscolar}</td>
                    <td>${cursor.value.usuario}</td>
                    <td>${cursor.value.altitud}</td>
                    <td>${cursor.value.longitud}</td>
                    <td>${cursor.value.estado}</td>
                `;
                document.getElementById("tablaRegistros").appendChild(fila);

                cursor.continue();
            }
        };
    };

    // Manejador de error de la apertura de la base de datos
    dataBase.onerror = function (e) {
        console.error('Error en el proceso: '+e.target.errorCode);
    };
</script>

</body>
</html>
